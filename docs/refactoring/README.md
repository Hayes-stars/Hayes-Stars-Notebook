# 重构 refactoring 

- 《重构2》读书笔记归纳，改善既有代码的设计

> 当今软件开发的速度越来越快，带来的技术债也越来越多，在开发过程中充分认识到重构的重要性————如果我们程序员能理解和掌握冲动原则和方法，我们的系统就不会有那么多沉重的债务。

## 何谓重构

- 对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本。
- 使用一系列重构手法，在不改变软件可观察行为的前提下，调整其结构。
- 如果代码在重构过程中有一两天时间不可用，基本上可以确定，这不是重构。
- 重构的唯一目的就是让我们开发更快，用更少的工作量创造更大的价值。

## 为何重构

- 重构改进软件的设计；
- 重构使软件更容易理解；
- 重构帮助找到bug；
- 重构提高编程速度。

## 何时重构

**三次法则**

- 第一次做某件事时只管去做；
- 第二次做类似的事会产生反感，但无论如何还是可以去做；
- 第三次再做类似的事，你就应该重构。俗话说的好"事不过三，三则重构"。

**让添加新功能更容易**

- 重构的最佳时机就在添加新功能之前。

**使代码更易懂**

- 能不能重构这段代码，令其一目了然？

**捡垃圾式的重构**

- 如果每次查看字段代码时都把它变好一点点，积少成多，垃圾总会被处理干净。

**有机会的重构和见机行事的重构**

- 权衡取舍计划重构如：参数化需要做到什么程度？函数之间的边界应该划在哪里？
- 肮脏的代码必须重构，但漂亮的代码也需要很多重构。

**大型重构**

- 替换正在使用的库，或者整块代码抽取到一个组件中共享，再或者要处理一大堆混乱的依赖关系等等。

**代码评审时重构**

- 在代码评审过程中获得的很多有用的建议。

**何时不应该重构**
- 如果重写比重构还容易，就别重构了。当然这个也是比较困难的一个决定，需要花时间去尝试。

## 测试

> 重构风险大，可能会引入bug，要有良好的测试过程。
